{
  "_format": "hh-sol-artifact-1",
  "contractName": "DDoSDefenseRegistry",
  "sourceName": "blockchain/contracts/DDoSDefenseRegistry.sol",
  "abi": [
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "attackId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "bytes32",
          "name": "ipHash",
          "type": "bytes32"
        },
        {
          "indexed": false,
          "internalType": "string",
          "name": "attackType",
          "type": "string"
        },
        {
          "indexed": false,
          "internalType": "uint8",
          "name": "severity",
          "type": "uint8"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "timestamp",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "reporter",
          "type": "address"
        }
      ],
      "name": "AttackLogged",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "attackId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "node",
          "type": "address"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "timestamp",
          "type": "uint256"
        }
      ],
      "name": "DefenseActivated",
      "type": "event"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "_attackId",
          "type": "uint256"
        }
      ],
      "name": "activateDefense",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "name": "attacks",
      "outputs": [
        {
          "internalType": "bytes32",
          "name": "ipHash",
          "type": "bytes32"
        },
        {
          "internalType": "string",
          "name": "attackType",
          "type": "string"
        },
        {
          "internalType": "uint8",
          "name": "severity",
          "type": "uint8"
        },
        {
          "internalType": "uint256",
          "name": "timestamp",
          "type": "uint256"
        },
        {
          "internalType": "address",
          "name": "reporter",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "_attackId",
          "type": "uint256"
        }
      ],
      "name": "getAttack",
      "outputs": [
        {
          "internalType": "bytes32",
          "name": "ipHash",
          "type": "bytes32"
        },
        {
          "internalType": "string",
          "name": "attackType",
          "type": "string"
        },
        {
          "internalType": "uint8",
          "name": "severity",
          "type": "uint8"
        },
        {
          "internalType": "uint256",
          "name": "timestamp",
          "type": "uint256"
        },
        {
          "internalType": "address",
          "name": "reporter",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "getAttackCount",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "_ipHash",
          "type": "bytes32"
        }
      ],
      "name": "getThreatCount",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "_ipHash",
          "type": "bytes32"
        }
      ],
      "name": "isThreatKnown",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "",
          "type": "bytes32"
        }
      ],
      "name": "knownThreats",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "_ipHash",
          "type": "bytes32"
        },
        {
          "internalType": "string",
          "name": "_attackType",
          "type": "string"
        },
        {
          "internalType": "uint8",
          "name": "_severity",
          "type": "uint8"
        },
        {
          "internalType": "uint256",
          "name": "_timestamp",
          "type": "uint256"
        }
      ],
      "name": "logAttack",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "",
          "type": "bytes32"
        }
      ],
      "name": "threatCount",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    }
  ],
  "bytecode": "0x6080604052348015600f57600080fd5b50610a178061001f6000396000f3fe608060405234801561001057600080fd5b50600436106100935760003560e01c8063b58b33a211610066578063b58b33a214610126578063cff840f014610149578063d78b1d391461016d578063e942550a14610180578063efbe5ba81461018857600080fd5b8063034531211461009857806328018be9146100ad578063467ce7ec146100e55780639bc6093414610113575b600080fd5b6100ab6100a636600461068c565b6101a8565b005b6100d06100bb36600461068c565b60016020526000908152604090205460ff1681565b60405190151581526020015b60405180910390f35b6101056100f336600461068c565b60026020526000908152604090205481565b6040519081526020016100dc565b6101056101213660046106d1565b61022c565b6100d061013436600461068c565b60009081526001602052604090205460ff1690565b61015c61015736600461068c565b61043f565b6040516100dc9594939291906107f2565b61015c61017b36600461068c565b6105b3565b600054610105565b61010561019636600461068c565b60009081526002602052604090205490565b60005481106101f25760405162461bcd60e51b8152602060048201526011602482015270125b9d985b1a5908185d1d1858dac81251607a1b60448201526064015b60405180910390fd5b604051428152339082907fcb1af5e1365f57fa6224f8b1260639370c90f2479c9ad7b982275c1f4b317e929060200160405180910390a350565b600060018360ff16101580156102465750600a8360ff1611155b61028a5760405162461bcd60e51b815260206004820152601560248201527405365766572697479206d75737420626520312d313605c1b60448201526064016101e9565b600082116102ce5760405162461bcd60e51b81526020600482015260116024820152700496e76616c69642074696d657374616d7607c1b60448201526064016101e9565b600080546040805160a0810182528881526020810188815260ff881692820192909252606081018690523360808201526001830184559280528251600583027f290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e5638101918255915192939283927f290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e564019061036790826108bd565b506040828101516002808401805460ff90931660ff1993841617905560608501516003850155608090940151600490930180546001600160a01b039094166001600160a01b03199094169390931790925560008a8152600160208181528383208054909516821790945593909252812080549091906103e790849061097c565b92505081905550336001600160a01b031687837f9e781684a1e84964e09f8b6d4fa2206a084c096f160f1a6925cc87db00ee888389898960405161042d939291906109a3565b60405180910390a45095945050505050565b6000606060008060008080549050861061048f5760405162461bcd60e51b8152602060048201526011602482015270125b9d985b1a5908185d1d1858dac81251607a1b60448201526064016101e9565b60008087815481106104a3576104a36109cb565b90600052602060002090600502016040518060a0016040529081600082015481526020016001820180546104d690610834565b80601f016020809104026020016040519081016040528092919081815260200182805461050290610834565b801561054f5780601f106105245761010080835404028352916020019161054f565b820191906000526020600020905b81548152906001019060200180831161053257829003601f168201915b5050509183525050600282015460ff1660208083019190915260038301546040808401919091526004909301546001600160a01b03166060928301528351908401519284015191840151608090940151909b929a5090985091965090945092505050565b600081815481106105c357600080fd5b600091825260209091206005909102018054600182018054919350906105e890610834565b80601f016020809104026020016040519081016040528092919081815260200182805461061490610834565b80156106615780601f1061063657610100808354040283529160200191610661565b820191906000526020600020905b81548152906001019060200180831161064457829003601f168201915b5050505060028301546003840154600490940154929360ff909116929091506001600160a01b031685565b60006020828403121561069e57600080fd5b5035919050565b634e487b7160e01b600052604160045260246000fd5b803560ff811681146106cc57600080fd5b919050565b600080600080608085870312156106e757600080fd5b84359350602085013567ffffffffffffffff81111561070557600080fd5b8501601f8101871361071657600080fd5b803567ffffffffffffffff811115610730576107306106a5565b604051601f8201601f19908116603f0116810167ffffffffffffffff8111828210171561075f5761075f6106a5565b60405281815282820160200189101561077757600080fd5b8160208401602083013760006020838301015280955050505061079c604086016106bb565b9396929550929360600135925050565b6000815180845260005b818110156107d2576020818501810151868301820152016107b6565b506000602082860101526020601f19601f83011685010191505092915050565b85815260a06020820152600061080b60a08301876107ac565b60ff9590951660408301525060608101929092526001600160a01b031660809091015292915050565b600181811c9082168061084857607f821691505b60208210810361086857634e487b7160e01b600052602260045260246000fd5b50919050565b601f8211156108b857806000526020600020601f840160051c810160208510156108955750805b601f840160051c820191505b818110156108b557600081556001016108a1565b50505b505050565b815167ffffffffffffffff8111156108d7576108d76106a5565b6108eb816108e58454610834565b8461086e565b6020601f82116001811461091f57600083156109075750848201515b600019600385901b1c1916600184901b1784556108b5565b600084815260208120601f198516915b8281101561094f578785015182556020948501946001909201910161092f565b508482101561096d5786840151600019600387901b60f8161c191681555b50505050600190811b01905550565b8082018082111561099d57634e487b7160e01b600052601160045260246000fd5b92915050565b6060815260006109b660608301866107ac565b60ff9490941660208301525060400152919050565b634e487b7160e01b600052603260045260246000fdfea2646970667358221220b395341d215c764e8781cad06494e3c20fa8535feddfdd12ab7aa7a82d44385364736f6c634300081c0033",
  "deployedBytecode": "0x608060405234801561001057600080fd5b50600436106100935760003560e01c8063b58b33a211610066578063b58b33a214610126578063cff840f014610149578063d78b1d391461016d578063e942550a14610180578063efbe5ba81461018857600080fd5b8063034531211461009857806328018be9146100ad578063467ce7ec146100e55780639bc6093414610113575b600080fd5b6100ab6100a636600461068c565b6101a8565b005b6100d06100bb36600461068c565b60016020526000908152604090205460ff1681565b60405190151581526020015b60405180910390f35b6101056100f336600461068c565b60026020526000908152604090205481565b6040519081526020016100dc565b6101056101213660046106d1565b61022c565b6100d061013436600461068c565b60009081526001602052604090205460ff1690565b61015c61015736600461068c565b61043f565b6040516100dc9594939291906107f2565b61015c61017b36600461068c565b6105b3565b600054610105565b61010561019636600461068c565b60009081526002602052604090205490565b60005481106101f25760405162461bcd60e51b8152602060048201526011602482015270125b9d985b1a5908185d1d1858dac81251607a1b60448201526064015b60405180910390fd5b604051428152339082907fcb1af5e1365f57fa6224f8b1260639370c90f2479c9ad7b982275c1f4b317e929060200160405180910390a350565b600060018360ff16101580156102465750600a8360ff1611155b61028a5760405162461bcd60e51b815260206004820152601560248201527405365766572697479206d75737420626520312d313605c1b60448201526064016101e9565b600082116102ce5760405162461bcd60e51b81526020600482015260116024820152700496e76616c69642074696d657374616d7607c1b60448201526064016101e9565b600080546040805160a0810182528881526020810188815260ff881692820192909252606081018690523360808201526001830184559280528251600583027f290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e5638101918255915192939283927f290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e564019061036790826108bd565b506040828101516002808401805460ff90931660ff1993841617905560608501516003850155608090940151600490930180546001600160a01b039094166001600160a01b03199094169390931790925560008a8152600160208181528383208054909516821790945593909252812080549091906103e790849061097c565b92505081905550336001600160a01b031687837f9e781684a1e84964e09f8b6d4fa2206a084c096f160f1a6925cc87db00ee888389898960405161042d939291906109a3565b60405180910390a45095945050505050565b6000606060008060008080549050861061048f5760405162461bcd60e51b8152602060048201526011602482015270125b9d985b1a5908185d1d1858dac81251607a1b60448201526064016101e9565b60008087815481106104a3576104a36109cb565b90600052602060002090600502016040518060a0016040529081600082015481526020016001820180546104d690610834565b80601f016020809104026020016040519081016040528092919081815260200182805461050290610834565b801561054f5780601f106105245761010080835404028352916020019161054f565b820191906000526020600020905b81548152906001019060200180831161053257829003601f168201915b5050509183525050600282015460ff1660208083019190915260038301546040808401919091526004909301546001600160a01b03166060928301528351908401519284015191840151608090940151909b929a5090985091965090945092505050565b600081815481106105c357600080fd5b600091825260209091206005909102018054600182018054919350906105e890610834565b80601f016020809104026020016040519081016040528092919081815260200182805461061490610834565b80156106615780601f1061063657610100808354040283529160200191610661565b820191906000526020600020905b81548152906001019060200180831161064457829003601f168201915b5050505060028301546003840154600490940154929360ff909116929091506001600160a01b031685565b60006020828403121561069e57600080fd5b5035919050565b634e487b7160e01b600052604160045260246000fd5b803560ff811681146106cc57600080fd5b919050565b600080600080608085870312156106e757600080fd5b84359350602085013567ffffffffffffffff81111561070557600080fd5b8501601f8101871361071657600080fd5b803567ffffffffffffffff811115610730576107306106a5565b604051601f8201601f19908116603f0116810167ffffffffffffffff8111828210171561075f5761075f6106a5565b60405281815282820160200189101561077757600080fd5b8160208401602083013760006020838301015280955050505061079c604086016106bb565b9396929550929360600135925050565b6000815180845260005b818110156107d2576020818501810151868301820152016107b6565b506000602082860101526020601f19601f83011685010191505092915050565b85815260a06020820152600061080b60a08301876107ac565b60ff9590951660408301525060608101929092526001600160a01b031660809091015292915050565b600181811c9082168061084857607f821691505b60208210810361086857634e487b7160e01b600052602260045260246000fd5b50919050565b601f8211156108b857806000526020600020601f840160051c810160208510156108955750805b601f840160051c820191505b818110156108b557600081556001016108a1565b50505b505050565b815167ffffffffffffffff8111156108d7576108d76106a5565b6108eb816108e58454610834565b8461086e565b6020601f82116001811461091f57600083156109075750848201515b600019600385901b1c1916600184901b1784556108b5565b600084815260208120601f198516915b8281101561094f578785015182556020948501946001909201910161092f565b508482101561096d5786840151600019600387901b60f8161c191681555b50505050600190811b01905550565b8082018082111561099d57634e487b7160e01b600052601160045260246000fd5b92915050565b6060815260006109b660608301866107ac565b60ff9490941660208301525060400152919050565b634e487b7160e01b600052603260045260246000fdfea2646970667358221220b395341d215c764e8781cad06494e3c20fa8535feddfdd12ab7aa7a82d44385364736f6c634300081c0033",
  "linkReferences": {},
  "deployedLinkReferences": {}
}
